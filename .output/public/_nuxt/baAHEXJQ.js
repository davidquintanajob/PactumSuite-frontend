import{r as d,k as h,M as w,y as f,z as p,K as S,L as I,A as K,a0 as L,O as F,P as q,J as z,H as C,B as E}from"#entry";const N={class:"relative w-full"},O=["placeholder","disabled","aria-expanded","aria-activedescendant"],R=["id","onMousedown","onMouseenter","aria-selected"],U={__name:"SelectSearch",props:{options:{type:Array,required:!0},labelKey:{type:[String,Function],required:!0},valueKey:{type:String,required:!0},modelValue:[String,Number],placeholder:{type:String,default:"Buscar..."},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:k}){const a=o,x=k,t=d(""),r=d(!1),n=d(-1),c=`dropdown-${Math.random().toString(36).substr(2,9)}`,g=d(null);function i(e){return typeof a.labelKey=="function"?a.labelKey(e):typeof a.labelKey=="string"?e[a.labelKey]:""}const s=h(()=>t.value?a.options.filter(e=>String(i(e)).toLowerCase().includes(t.value.toLowerCase())):a.options),y=e=>`${c}-option-${e}`,V=h(()=>n.value>=0?y(n.value):void 0);w(()=>a.modelValue,e=>{if(e!=null){const l=a.options.find(u=>String(u[a.valueKey])===String(e));l?t.value=i(l):t.value=""}else t.value=""},{immediate:!0}),w(()=>a.options,()=>{if(a.modelValue!==void 0&&a.modelValue!==null){const e=a.options.find(l=>String(l[a.valueKey])===String(a.modelValue));e&&(t.value=i(e))}},{immediate:!0});const b=e=>{a.disabled||(x("update:modelValue",e[a.valueKey]),t.value=i(e),r.value=!1)},m=e=>{if(r.value||(r.value=!0),s.value.length===0)return;let l=n.value+e;l<0&&(l=s.value.length-1),l>=s.value.length&&(l=0),n.value=l},B=()=>{n.value>=0&&n.value<s.value.length&&b(s.value[n.value])},M=()=>{setTimeout(()=>{r.value=!1},100)},D=()=>{a.disabled||(r.value=!0),t.value&&g.value.select()},$=e=>{if(!a.disabled)switch(e.key){case"ArrowDown":e.preventDefault(),m(1);break;case"ArrowUp":e.preventDefault(),m(-1);break;case"Enter":e.preventDefault(),B();break;case"Escape":r.value=!1,n.value=-1;break}};return(e,l)=>(p(),f("div",N,[S(K("input",{ref_key:"inputRef",ref:g,type:"text","onUpdate:modelValue":l[0]||(l[0]=u=>t.value=u),placeholder:o.placeholder,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:o.disabled,onFocus:D,onInput:l[1]||(l[1]=u=>!o.disabled&&(r.value=!0)),onKeydown:$,onBlur:M,"aria-expanded":r.value.toString(),"aria-controls":c,"aria-activedescendant":V.value},null,40,O),[[I,t.value]]),S(K("ul",{id:c,class:"absolute z-10 w-full bg-white border border-gray-300 rounded-lg mt-1 max-h-60 overflow-auto shadow-lg",role:"listbox"},[(p(!0),f(F,null,q(s.value,(u,v)=>(p(),f("li",{key:u[o.valueKey],id:y(v),class:C(["px-4 py-2 cursor-pointer",v===n.value?"bg-accent/30":"hover:bg-gray-100"]),onMousedown:z(A=>b(u),["prevent"]),onMouseenter:A=>n.value=v,role:"option","aria-selected":String(o.modelValue)===String(u[o.valueKey])},E(i(u)),43,R))),128))],512),[[L,r.value&&s.value.length>0]])]))}};export{U as _};
