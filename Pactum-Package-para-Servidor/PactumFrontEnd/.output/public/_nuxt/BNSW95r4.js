import{S as P}from"./tYk8DSAs.js";import{N as G}from"./uqRIYar1.js";import{D as L}from"./B1U57Od_.js";import{r as e,J as O,x as f,E as h,y as g,z as o,B as b,A as S,F as q,G as J,H as U,D as N,_ as R,o as F,n as K,q as j,h as _}from"./DLx_sSSf.js";import{_ as A}from"./DTo_Qbs3.js";import{_ as Q}from"./DlY85phm.js";import"./ETKJmL_A.js";const W={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},X={key:0,class:"fixed top-6 left-1/2 transform -translate-x-1/2 z-[9999] w-full max-w-md px-4 pointer-events-none"},Y={class:"bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto"},Z={class:"flex justify-between items-center mb-6"},ee={class:"text-2xl font-bold text-gray-800"},te={class:"space-y-4"},oe=["readonly","disabled"],ae={key:0,class:"flex justify-end space-x-4 mt-6"},ne=["disabled"],se=["disabled"],re={key:0,class:"flex items-center"},ie={key:1},le={key:0,class:"text-red-600 text-sm mt-2"},ue={__name:"TipoContratoModal",props:{modelValue:{type:Boolean,required:!0},tipoContrato:{type:Object,default:()=>({})},isEditing:{type:Boolean,default:!1},isViewing:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],setup(d,{emit:w}){const k=d,x=w,p=e({nombre:""}),y=e(""),l=e(!1),c=e(null);O(()=>k.tipoContrato,r=>{r&&Object.keys(r).length>0?p.value={nombre:r.nombre||""}:p.value={nombre:""}},{immediate:!0});const m=async()=>{if(y.value="",!p.value.nombre){y.value="El nombre es obligatorio.";return}l.value=!0,c.value={title:k.isEditing?"Guardando Tipo de Contrato":"Creando Tipo de Contrato",description:"Comunicando con el servidor, espere por favor...",type:"warning"};try{await new Promise((r,t)=>{x("submit",p.value),setTimeout(r,100)})}catch(r){console.error("Error en handleSubmit:",r)}finally{setTimeout(()=>{l.value=!1,c.value=null},500)}};return(r,t)=>d.modelValue?(g(),f("div",W,[c.value?(g(),f("div",X,[b(A,{title:c.value.title,description:c.value.description,type:c.value.type,onClose:t[0]||(t[0]=v=>c.value=null),class:"pointer-events-auto"},null,8,["title","description","type"])])):h("",!0),o("div",Y,[o("div",Z,[o("h2",ee,S(d.isViewing?"Detalles de Tipo de Contrato":d.isEditing?"Editar Tipo de Contrato":"Nuevo Tipo de Contrato"),1),o("button",{onClick:t[1]||(t[1]=v=>r.$emit("update:modelValue",!1)),class:"text-gray-500 hover:text-gray-700"},[...t[4]||(t[4]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),o("form",{onSubmit:q(m,["prevent"]),class:"space-y-4"},[o("div",te,[o("div",null,[t[5]||(t[5]=o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nombre",-1)),J(o("input",{"onUpdate:modelValue":t[2]||(t[2]=v=>p.value.nombre=v),type:"text",class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",required:"",readonly:d.isViewing,disabled:d.isViewing||l.value,placeholder:"Ingrese el nombre del tipo de contrato"},null,8,oe),[[U,p.value.nombre]])])]),d.isViewing?h("",!0):(g(),f("div",ae,[o("button",{type:"button",onClick:t[3]||(t[3]=v=>r.$emit("update:modelValue",!1)),class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",disabled:l.value}," Cancelar ",8,ne),o("button",{type:"submit",class:"px-4 py-2 text-neutral bg-primary rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:l.value},[l.value?(g(),f("span",re,[t[6]||(t[6]=o("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),N(" "+S(d.isEditing?"Guardando...":"Creando..."),1)])):(g(),f("span",ie,S(d.isEditing?"Guardar Cambios":"Crear Tipo de Contrato"),1))],8,se)]))],32),y.value?(g(),f("div",le,S(y.value),1)):h("",!0)])])):h("",!0)}},ce={class:"min-h-screen bg-gradient-to-br via-secondary/40 from-accent/30 to-neutral"},de={key:0,class:"fixed top-6 left-1/2 transform -translate-x-1/2 z-[9999] w-full max-w-md px-4 pointer-events-none"},pe={key:1,class:"fixed top-24 left-1/2 transform -translate-x-1/2 z-[10000] w-full max-w-md px-4 pointer-events-auto"},me={class:"container mx-auto px-4 py-4 md:py-4 pt-8 md:pt-4"},ve={__name:"tipos-contratos",setup(d){e(""),e(""),e(""),e(""),e(""),e(""),e(""),e(!1);const w=K(),k=[{key:"id_tipo_contrato",label:"ID"},{key:"nombre",label:"Nombre del Tipo Contrato"}],x=e(1),p=e(0),y=e(!1),l=e(20),c=e([]),m=e(!1),r=e({}),t=e(!1),v=e(!1),n=e(null),T=e(!1),E=e(null),$=async(s=1,a=20)=>{try{y.value=!0;const u=localStorage.getItem("token"),i=await fetch(`${w.public.backendHost}/tipoContrato`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:u,Accept:"application/json"}});if(i.status===401){n.value={title:"Sesión Expirada",description:"Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",type:"warning"},localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{j("/")},3e3);return}if(i.status===403){n.value={title:"Acceso Denegado",description:"No tienes permisos para realizar esta acción o acceder a esta información.",type:"error"};return}const C=await i.json();c.value=C.data||[],p.value=c.value.length}catch(u){console.error("Error al cargar las entidades:",u)}finally{y.value=!1}},B=s=>{x.value=s,$(s,l.value)};F(()=>{$(1,l.value)});const z={render(){return _("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-neutral",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[_("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})])}};async function I(){if(T.value=!1,!!E.value)try{const s=localStorage.getItem("token"),a=await fetch(`${w.public.backendHost}/tipoContrato/deleteContrato/${E.value.id_tipo_contrato}`,{method:"DELETE",headers:{Authorization:s,Accept:"application/json"}});if(a.status===401){n.value={title:"Sesión Expirada",description:"Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",type:"warning"},localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{j("/")},3e3);return}if(a.status===403){n.value={title:"Acceso Denegado",description:"No tienes permisos para realizar esta acción o acceder a esta información.",type:"error"};return}if(!a.ok){const u=await a.json();n.value={title:`Error al eliminar: ${a.status}`,description:u.message||JSON.stringify(u),type:"error"};return}n.value={title:"Tipo de Contrato eliminado",description:"El tipo de contrato fue eliminado correctamente",type:"success"},await $(x.value,l.value)}catch(s){n.value={title:"Error",description:s.message,type:"error"}}finally{E.value=null}}const V=[{name:"Editar",icon:{render(){return _("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[_("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})])}},handler:s=>{r.value={...s},t.value=!0,v.value=!1,m.value=!0}},{name:"Eliminar",icon:z,handler:s=>{E.value=s,T.value=!0}}];V[0].buttonClass="px-3 py-1 bg-accent text-neutral rounded-md hover:bg-accent/90",V[1].buttonClass="px-3 py-1 bg-danger text-neutral rounded-md hover:bg-danger/90";const M=s=>{r.value={...s},t.value=!1,v.value=!0,m.value=!0};function D(){r.value={},t.value=!1,v.value=!1,m.value=!0}const H=async s=>{try{const a=localStorage.getItem("token"),u=t.value?`${w.public.backendHost}/tipoContrato/UpdateContrato/${r.value.id_tipo_contrato}`:`${w.public.backendHost}/tipoContrato/CreateContrato`,i=await fetch(u,{method:t.value?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:a,Accept:"application/json"},body:JSON.stringify(s)});if(i.status===401){n.value={title:"Sesión Expirada",description:"Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",type:"warning"},localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{j("/")},3e3);return}if(i.status===403){n.value={title:"Acceso Denegado",description:"No tienes permisos para realizar esta acción o acceder a esta información.",type:"error"};return}if(i.status===400||i.status===500){const C=await i.json();C.error?n.value={title:`Errores de validación: ${i.status}`,description:C.message,type:"error"}:n.value={title:`Error: ${i.status}`,description:JSON.stringify(C),type:"error"};return}i.ok?(t.value?(n.value={title:`Tipo de Contrato Actualizado: ${i.status}`,description:`El tipo de contrato ${s.nombre} se actualizó con éxito`,type:"success"},m.value=!1):(n.value={title:`Tipo de Contrato Creado: ${i.status}`,description:`El tipo de contrato ${s.nombre} se creó con éxito`,type:"success"},m.value=!1),await $(x.value,l.value)):console.error("Error al guardar el tipo de contrato")}catch(a){console.error("Error:",a)}};return(s,a)=>(g(),f("div",ce,[b(P,{title:"Tipos de Contrato - Contract Manager",description:"Gestiona los diferentes tipos de contrato disponibles.",canonical:"/tipos-contratos"}),b(G),n.value?(g(),f("div",de,[b(A,{title:n.value.title,description:n.value.description,type:n.value.type,onClose:a[0]||(a[0]=u=>n.value=null),class:"pointer-events-auto"},null,8,["title","description","type"])])):h("",!0),T.value?(g(),f("div",pe,[b(Q,{title:"¿Estás seguro que deseas eliminar este tipo de contrato?",description:"Esta acción no se puede deshacer.",icon:z,type:"warning",onConfirm:I,onClose:a[1]||(a[1]=u=>T.value=!1)})])):h("",!0),o("div",me,[o("div",{class:"flex justify-between items-center mb-4"},[a[4]||(a[4]=o("h2",{class:"text-2xl font-bold mb-4"},"Tipos de Contrato",-1)),o("button",{onClick:D,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center"},[...a[3]||(a[3]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),N(" Nuevo Tipo de Contrato ",-1)])])]),b(L,{columns:k,items:c.value,actions:V,"total-items":p.value,"items-per-page":l.value,"current-page":x.value,"is-loading":y.value,onPageChange:B,onRowClick:M},null,8,["items","total-items","items-per-page","current-page","is-loading"]),b(ue,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=u=>m.value=u),"tipo-contrato":r.value,"is-editing":t.value,"is-viewing":v.value,onSubmit:H},null,8,["modelValue","tipo-contrato","is-editing","is-viewing"])])]))}},Ce=R(ve,[["__scopeId","data-v-386e9101"]]);export{Ce as default};
