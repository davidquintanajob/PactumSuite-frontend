import{r as u,J as ae,x as y,E as N,y as w,z as e,B as D,A as V,F as re,G as h,H as k,D as K,K as ne,L as ie,u as se,o as le,Q as H,n as O,h as J}from"./DLx_sSSf.js";import{S as de}from"./tYk8DSAs.js";import{N as ue}from"./uqRIYar1.js";import{D as ce}from"./B1U57Od_.js";import{_ as G}from"./DTo_Qbs3.js";import{_ as pe}from"./DlY85phm.js";import{u as F,w as R}from"./3SA47z_C.js";import"./ETKJmL_A.js";const me={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},ge={key:0,class:"fixed top-6 left-1/2 transform -translate-x-1/2 z-[9999] w-full max-w-md px-4 pointer-events-none"},ve={class:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto"},fe={class:"flex justify-between items-center mb-6"},xe={class:"text-2xl font-bold text-gray-800"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye=["readonly","disabled"],we=["readonly","disabled"],he=["readonly","disabled"],ke=["readonly","disabled"],Ce=["readonly","disabled"],Pe={key:0},Ee=["required"],Ve=["readonly","disabled"],Ne=["readonly","disabled"],Se={key:0,class:"flex justify-end space-x-4 mt-6"},$e=["disabled"],Me=["disabled"],je={key:0,class:"flex items-center"},De={key:1},Te={key:0,class:"mt-6"},ze={class:"overflow-x-auto"},Ie={class:"min-w-full bg-white border border-gray-300"},Fe={class:"bg-white divide-y divide-gray-200"},Ae={class:"px-4 py-2 whitespace-nowrap text-sm text-gray-900"},Be={class:"px-4 py-2 whitespace-nowrap text-sm"},He=["innerHTML"],Oe={class:"px-4 py-2 whitespace-nowrap text-sm text-gray-900"},Ue={class:"px-4 py-2 whitespace-nowrap text-sm"},Le=["innerHTML"],qe={class:"px-4 py-2 whitespace-nowrap text-sm text-gray-900"},Je={class:"px-4 py-2 whitespace-nowrap text-sm text-gray-900"},Ke={class:"px-4 py-2 whitespace-nowrap text-sm text-gray-900"},Re={key:1,class:"text-red-600 text-sm mt-2"},Ge={__name:"ProductoModal",props:{modelValue:{type:Boolean,required:!0},producto:{type:Object,default:()=>({})},isEditing:{type:Boolean,default:!1},isViewing:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],setup(d,{emit:T}){const x=d,S=T,n=u({codigo:"",nombre:"",precio:"",nota:"",unidadMedida:"",tipoProducto:"",cantidadExistencia:0,costo:0}),b=u(""),m=u(!1),C=u(null);ae(()=>x.producto,i=>{i&&Object.keys(i).length>0?n.value={codigo:i.codigo||"",nombre:i.nombre||"",precio:i.precio||"",nota:i.nota||"",unidadMedida:i.unidadMedida||"",tipoProducto:i.tipoProducto||"",cantidadExistencia:i.cantidadExistencia||0,costo:i.costo||0}:n.value={codigo:"",nombre:"",precio:"",nota:"",unidadMedida:"",tipoProducto:"",cantidadExistencia:0,costo:0}},{immediate:!0});const $=async()=>{b.value="";const i=["codigo","nombre","precio","unidadMedida","tipoProducto","costo"];x.isEditing&&i.push("cantidadExistencia");const t=i.filter(o=>!n.value[o]);if(t.length>0){b.value="Los campos "+t.join(", ")+" son obligatorios.";return}m.value=!0,C.value={title:x.isEditing?"Guardando Producto":"Creando Producto",description:"Comunicando con el servidor, espere por favor...",type:"warning"};try{await new Promise((o,P)=>{S("submit",{codigo:n.value.codigo,nombre:n.value.nombre,precio:Number(n.value.precio),nota:n.value.nota,unidadMedida:n.value.unidadMedida,tipoProducto:n.value.tipoProducto,cantidadExistencia:x.isEditing?Number(n.value.cantidadExistencia):0,costo:Number(n.value.costo)}),setTimeout(o,100)})}catch(o){console.error("Error en handleSubmit:",o)}finally{setTimeout(()=>{m.value=!1,C.value=null},500)}};function M(i){if(!i)return"";let t="",o="";return i==="Facturado"?(t="bg-green-100",o="text-green-800"):i==="No Facturado"?(t="bg-yellow-100",o="text-yellow-800"):i==="Cancelado"&&(t="bg-red-100",o="text-red-800"),`<span class="px-2 py-1 rounded-full text-sm font-medium ${t} ${o}">${i}</span>`}function j(i){if(!i)return"";let t="",o="";if(i==="Proveedor")t="bg-yellow-100",o="text-yellow-800";else if(i==="Cliente")t="bg-blue-100",o="text-blue-800";else return"";return`<span class="px-2 py-1 rounded-full text-sm font-medium ${t} ${o}">${i}</span>`}return(i,t)=>d.modelValue?(w(),y("div",me,[C.value?(w(),y("div",ge,[D(G,{title:C.value.title,description:C.value.description,type:C.value.type,onClose:t[0]||(t[0]=o=>C.value=null),class:"pointer-events-auto"},null,8,["title","description","type"])])):N("",!0),e("div",ve,[e("div",fe,[e("h2",xe,V(d.isViewing?"Detalles de Producto":d.isEditing?"Editar Producto":"Nuevo Producto"),1),e("button",{onClick:t[1]||(t[1]=o=>i.$emit("update:modelValue",!1)),class:"text-gray-500 hover:text-gray-700"},[...t[11]||(t[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:re($,["prevent"]),class:"space-y-4"},[e("div",be,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Código",-1)),h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>n.value.codigo=o),type:"text",required:"",readonly:d.isViewing,disabled:d.isViewing||m.value,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el código del producto"},null,8,ye),[[k,n.value.codigo]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nombre",-1)),h(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>n.value.nombre=o),type:"text",required:"",readonly:d.isViewing,disabled:d.isViewing||m.value,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el nombre del producto"},null,8,we),[[k,n.value.nombre]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Precio",-1)),h(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>n.value.precio=o),type:"number",step:"0.01",required:"",readonly:d.isViewing,disabled:d.isViewing||m.value,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el precio"},null,8,he),[[k,n.value.precio]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Unidad de Medida",-1)),h(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>n.value.unidadMedida=o),type:"text",required:"",readonly:d.isViewing,disabled:d.isViewing||m.value,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la unidad de medida"},null,8,ke),[[k,n.value.unidadMedida]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Producto",-1)),h(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>n.value.tipoProducto=o),type:"text",required:"",readonly:d.isViewing,disabled:d.isViewing||m.value,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el tipo de producto"},null,8,Ce),[[k,n.value.tipoProducto]])]),d.isEditing||d.isViewing?(w(),y("div",Pe,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Cantidad en Existencia",-1)),h(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>n.value.cantidadExistencia=o),type:"number",required:d.isEditing,readonly:!0,disabled:!0,class:"w-full px-4 py-2 rounded-lg border bg-gray-100 text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la cantidad en existencia"},null,8,Ee),[[k,n.value.cantidadExistencia]])])):N("",!0),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Costo",-1)),h(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>n.value.costo=o),type:"number",step:"0.01",required:"",readonly:d.isViewing,disabled:d.isViewing||m.value,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el costo"},null,8,Ve),[[k,n.value.costo]])])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nota",-1)),h(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=o=>n.value.nota=o),readonly:d.isViewing,disabled:d.isViewing||m.value,class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese una nota (opcional)",rows:"3"},null,8,Ne),[[k,n.value.nota]])]),d.isViewing?N("",!0):(w(),y("div",Se,[e("button",{type:"button",onClick:t[10]||(t[10]=o=>i.$emit("update:modelValue",!1)),class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",disabled:m.value}," Cancelar ",8,$e),e("button",{type:"submit",class:"px-4 py-2 text-neutral bg-primary rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:m.value},[m.value?(w(),y("span",je,[t[20]||(t[20]=e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),K(" "+V(d.isEditing?"Guardando...":"Creando..."),1)])):(w(),y("span",De,V(d.isEditing?"Guardar Cambios":"Crear Producto"),1))],8,Me)]))],32),(d.isViewing||d.isEditing)&&x.producto.facturaProductos&&x.producto.facturaProductos.length>0?(w(),y("div",Te,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Historial de Facturas",-1)),e("div",ze,[e("table",Ie,[t[21]||(t[21]=e("thead",null,[e("tr",{class:"bg-gray-50"},[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"N° Consecu"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cliente/Proveedor"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cantidad"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Precio Venta"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Costo Venta")])],-1)),e("tbody",Fe,[(w(!0),y(ne,null,ie(x.producto.facturaProductos,o=>(w(),y("tr",{key:o.id_factura_producto},[e("td",Ae,V(o.factura.num_consecutivo),1),e("td",Be,[e("span",{innerHTML:j(o.factura.contrato.ClienteOProveedor)},null,8,He)]),e("td",Oe,V(new Date(o.factura.fecha).toLocaleDateString()),1),e("td",Ue,[e("span",{innerHTML:M(o.factura.estado)},null,8,Le)]),e("td",qe,V(o.cantidad),1),e("td",Je,V(o.precioVenta),1),e("td",Ke,V(o.costoVenta),1)]))),128))])])])])):N("",!0),b.value?(w(),y("div",Re,V(b.value),1)):N("",!0)])])):N("",!0)}},Qe={class:"min-h-screen bg-gradient-to-br via-secondary/40 from-accent/30 to-neutral"},We={key:0,class:"fixed top-6 left-1/2 transform -translate-x-1/2 z-[9999] w-full max-w-md px-4 pointer-events-none"},_e={key:1,class:"fixed top-24 left-1/2 transform -translate-x-1/2 z-[10000] w-full max-w-md px-4 pointer-events-auto"},Xe={class:"w-[95%] mx-auto px-4 py-4 md:py-4 mt-20 md:mt-0"},Ye={class:"bg-white rounded-lg shadow-md p-4"},Ze={class:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end mb-4 md:mb-2"},et={class:"relative"},tt={class:"flex space-x-2"},ot={class:"flex-1"},at={class:"flex-1"},rt={class:"w-[95%] mx-auto px-4 py-4"},gt={__name:"productos",setup(d){const{navigateTo:T}=se(),x=u(""),S=u(""),n=u(""),b=u(""),m=u(""),C=u([]),$=u(0),M=u(10),j=u(1),i=u(!1),t=u(!1),o=u(null),P=u(!1),A=u(!1),s=u(null),U=u(!1),L=u(null),Q=[{key:"codigo",label:"Código"},{key:"nombre",label:"Nombre"},{key:"unidadMedida",label:"Unidad de Medida"},{key:"precio",label:"Precio"},{key:"costo",label:"Costo"},{key:"tipoProducto",label:"Tipo de Producto"},{key:"cantidadExistencia",label:"Existencia"}],W=[{name:"Editar",icon:{render(){return J("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[J("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})])}},handler:l=>{o.value=l,P.value=!0,A.value=!1,t.value=!0},buttonClass:"px-3 py-1 bg-accent text-neutral rounded-md hover:bg-accent/90"},{name:"Eliminar",icon:{render(){return J("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-neutral",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[J("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})])}},handler:l=>{L.value=l,U.value=!0},buttonClass:"px-3 py-1 bg-danger text-neutral rounded-md hover:bg-danger/90"}],B=async(l=j.value,a=M.value)=>{var r;i.value=!0;try{const p=localStorage.getItem("token"),v=O(),g={codigo:x.value,nombre:S.value,precio:{min:n.value?Number(n.value):void 0,max:b.value?Number(b.value):void 0},nota:m.value};!g.precio.min&&!g.precio.max?delete g.precio:(g.precio.min||delete g.precio.min,g.precio.max||delete g.precio.max);const E=await(await fetch(`${v.public.backendHost}/Producto/filterProductos/${l}/${a}`,{method:"POST",headers:{Authorization:p,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(g)})).json();C.value=Array.isArray(E.data)?E.data.map(I=>({...I,precio:Number(I.precio).toFixed(2)})):[],$.value=((r=E.pagination)==null?void 0:r.total)||0}catch{C.value=[],$.value=0}finally{i.value=!1}},_=l=>{j.value=l,B(l)},X=l=>{o.value=l,P.value=!1,A.value=!0,t.value=!0};le(()=>{B()});const Y=async l=>{try{const a=localStorage.getItem("token"),r=O(),p=P.value?`${r.public.backendHost}/Producto/updateProducto/${o.value.id_producto}`:`${r.public.backendHost}/Producto/createProducto`,v=await fetch(p,{method:P.value?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:a,Accept:"application/json"},body:JSON.stringify(l)});if(v.status===401){s.value={title:"Sesión Expirada",description:"Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",type:"warning"},localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{T("/")},3e3);return}if(v.status===403){s.value={title:"Acceso Denegado",description:"No tienes permisos para realizar esta acción o acceder a esta información.",type:"error"};return}if(v.status===400||v.status===500){const g=await v.json();g.error?s.value={title:`Errores de validación: ${v.status}`,description:g.message,type:"error"}:s.value={title:`Error: ${v.status}`,description:JSON.stringify(g),type:"error"};return}v.ok?(P.value?s.value={title:`Producto Actualizado: ${v.status}`,description:`El producto ${l.nombre} se actualizó con éxito`,type:"success"}:s.value={title:`Producto Creado: ${v.status}`,description:`El producto ${l.nombre} se creó con éxito`,type:"success"},await B(j.value,M.value),t.value=!1,o.value=null,P.value=!1,A.value=!1):console.error("Error al guardar el producto")}catch(a){console.error("Error:",a),s.value={title:"Error",description:a.message,type:"error"}}},Z=()=>{o.value=null,P.value=!1,A.value=!1,t.value=!0};async function ee(){if(U.value=!1,!!L.value)try{const l=localStorage.getItem("token"),a=O(),r=await fetch(`${a.public.backendHost}/Producto/DeleteProducto/${L.value.id_producto}`,{method:"DELETE",headers:{Authorization:l,Accept:"application/json"}});if(r.status===401){s.value={title:"Sesión Expirada",description:"Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",type:"warning"},localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{T("/")},3e3);return}if(r.status===403){s.value={title:"Acceso Denegado",description:"No tienes permisos para realizar esta acción o acceder a esta información.",type:"error"};return}if(!r.ok){const p=await r.json();s.value={title:`Error al eliminar: ${r.status}`,description:p.message||JSON.stringify(p),type:"error"};return}s.value={title:"Producto eliminado",description:"El producto fue eliminado correctamente",type:"success"},await B(j.value,M.value)}catch(l){s.value={title:"Error",description:l.message,type:"error"}}finally{L.value=null}}const z=async()=>{try{i.value=!0,await B(1,M.value)}catch(l){console.error("Error al buscar productos:",l)}finally{i.value=!1}};async function te(){s.value={title:"Consultando datos",description:"Se están consultando los datos, la descarga comenzará en breve.",type:"info"};try{const l=localStorage.getItem("token"),a=O(),r={codigo:x.value,nombre:S.value,precio:{min:n.value?Number(n.value):void 0,max:b.value?Number(b.value):void 0},nota:m.value};!r.precio.min&&!r.precio.max?delete r.precio:(r.precio.min||delete r.precio.min,r.precio.max||delete r.precio.max);const p=await fetch(`${a.public.backendHost}/Producto/filterProductos/1/${$.value}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:l,Accept:"application/json"},body:JSON.stringify(r)});if(p.status===401){s.value={title:"Sesión Expirada",description:"Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",type:"warning"},localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{T("/")},3e3);return}if(p.status===403){s.value={title:"Acceso Denegado",description:"No tienes permisos para realizar esta acción o acceder a esta información.",type:"error"};return}if(!p.ok){const c=await p.json();s.value={title:"Error al consultar datos",description:c.error||"Ocurrió un error al consultar los datos.",type:"error"};return}const g=(await p.json()).data.map(c=>({Código:c.codigo,Nombre:c.nombre,"Unidad de Medida":c.unidadMedida,Precio:Number(c.precio).toFixed(2),Nota:c.nota})),q=F.json_to_sheet(g),E=F.book_new();F.book_append_sheet(E,q,"Productos");const I=new Date().toISOString().split("T")[0];R(E,`productos_${I}.xlsx`),s.value=null}catch(l){console.error("Error al exportar a Excel:",l),s.value={title:"Error",description:"Ocurrió un error al exportar los datos.",type:"error"}}}async function oe(){s.value={title:"Consultando datos",description:"Se están consultando los datos, la descarga comenzará en breve.",type:"info"};try{const l=localStorage.getItem("token"),a=O(),r={codigo:x.value,nombre:S.value,precio:{min:n.value?Number(n.value):void 0,max:b.value?Number(b.value):void 0},nota:m.value};!r.precio.min&&!r.precio.max?delete r.precio:(r.precio.min||delete r.precio.min,r.precio.max||delete r.precio.max);const p=await fetch(`${a.public.backendHost}/Producto/filterProductos/1/${$.value}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:l,Accept:"application/json"},body:JSON.stringify(r)});if(p.status===401){s.value={title:"Sesión Expirada",description:"Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",type:"warning"},localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{T("/")},3e3);return}if(p.status===403){s.value={title:"Acceso Denegado",description:"No tienes permisos para realizar esta acción o acceder a esta información.",type:"error"};return}if(!p.ok){const c=await p.json();s.value={title:"Error al consultar datos",description:c.error||"Ocurrió un error al consultar los datos.",type:"error"};return}const v=await p.json(),g=[];v.data.forEach(c=>{Array.isArray(c.facturaProductos)&&c.facturaProductos.forEach(f=>{g.push({"Código Producto":c.codigo,"Nombre Producto":c.nombre,"Unidad Medida Producto":c.unidadMedida,"Precio Producto":Number(c.precio).toFixed(2),"Costo Producto":Number(c.costo).toFixed(2),"Tipo Producto":c.tipoProducto,"Existencia Producto":c.cantidadExistencia,"Nota Producto":c.nota,"Número Consecutivo Factura":f.factura.num_consecutivo,"Fecha Factura":f.factura.fecha?new Date(f.factura.fecha).toLocaleDateString("es-ES"):"","Estado Factura":f.factura.estado,"Nota Factura":f.factura.nota,Cantidad:Number(f.cantidad).toFixed(2),"Precio Venta":Number(f.precioVenta).toFixed(2),"Número Consecutivo Contrato":f.factura.contrato.num_consecutivo,"Fecha Inicio Contrato":f.factura.contrato.fecha_inicio?new Date(f.factura.contrato.fecha_inicio).toLocaleDateString("es-ES"):"","Fecha Fin Contrato":f.factura.contrato.fecha_fin?new Date(f.factura.contrato.fecha_fin).toLocaleDateString("es-ES"):"","Nota Contrato":f.factura.contrato.nota,"Cliente/Proveedor":f.factura.contrato.ClienteOProveedor,"Vigencia Facturas (Días)":f.factura.contrato.vigenciaFacturasDias})})});const q=F.json_to_sheet(g),E=F.book_new();F.book_append_sheet(E,q,"Productos con Ventas y Compras");const I=new Date().toISOString().split("T")[0];R(E,`productos_ventas_compras_${I}.xlsx`),s.value=null}catch(l){console.error("Error al exportar a Excel con ventas y compras:",l),s.value={title:"Error",description:"Ocurrió un error al exportar los datos.",type:"error"}}}return(l,a)=>(w(),y("div",Qe,[D(de,{title:"Productos - Contract Manager",description:"Registra y gestiona productos.",canonical:"/productos"}),D(ue),s.value?(w(),y("div",We,[D(G,{title:s.value.title,description:s.value.description,type:s.value.type,onClose:a[0]||(a[0]=r=>s.value=null),class:"pointer-events-auto"},null,8,["title","description","type"])])):N("",!0),U.value?(w(),y("div",_e,[D(pe,{title:"¿Estás seguro que deseas eliminar este producto?",description:"Esta acción no se puede deshacer.",type:"warning",onConfirm:ee,onClose:a[1]||(a[1]=r=>U.value=!1)})])):N("",!0),e("div",Xe,[e("div",Ye,[e("div",Ze,[e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Buscar por código",-1)),e("div",et,[h(e("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=r=>x.value=r),placeholder:"Ingrese el código...",class:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary",onKeyup:H(z,["enter"])},null,544),[[k,x.value]]),a[8]||(a[8]=e("div",{class:"absolute left-3 top-2.5"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),e("div",null,[a[10]||(a[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Buscar por nombre",-1)),h(e("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=r=>S.value=r),placeholder:"Ingrese el nombre...",class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary",onKeyup:H(z,["enter"])},null,544),[[k,S.value]])]),e("div",tt,[e("div",ot,[a[11]||(a[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Precio mínimo",-1)),h(e("input",{type:"number","onUpdate:modelValue":a[4]||(a[4]=r=>n.value=r),placeholder:"Precio min...",class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:H(z,["enter"])},null,544),[[k,n.value]])]),e("div",at,[a[12]||(a[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Precio máximo",-1)),h(e("input",{type:"number","onUpdate:modelValue":a[5]||(a[5]=r=>b.value=r),placeholder:"Precio max...",class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:H(z,["enter"])},null,544),[[k,b.value]])])]),e("div",null,[a[13]||(a[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nota",-1)),h(e("input",{type:"text","onUpdate:modelValue":a[6]||(a[6]=r=>m.value=r),placeholder:"Nota...",class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:H(z,["enter"])},null,544),[[k,m.value]])])]),e("div",{class:"flex justify-end mt-4 gap-2 flex-wrap"},[e("button",{onClick:z,class:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"}," Buscar "),e("button",{onClick:te,class:"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors flex items-center"},[...a[14]||(a[14]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 12h2v2H7v-2zM11 12h2v2h-2v-2zM15 12h2v2h-2v-2z"})],-1),K(" Exportar a Excel ",-1)])]),e("button",{onClick:oe,class:"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors flex items-center"},[...a[15]||(a[15]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),K(" Exportar Ventas y Compras ",-1)])])])])]),e("div",rt,[e("div",{class:"flex justify-between items-center mb-4"},[a[17]||(a[17]=e("h2",{class:"text-2xl font-bold"},"Productos",-1)),e("button",{onClick:Z,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center"},[...a[16]||(a[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),K(" Nuevo Producto ",-1)])])]),D(ce,{columns:Q,items:C.value,actions:W,"total-items":$.value,"items-per-page":M.value,"current-page":j.value,"is-loading":i.value,onPageChange:_,onRowClick:X},null,8,["items","total-items","items-per-page","current-page","is-loading"])]),D(Ge,{modelValue:t.value,"onUpdate:modelValue":a[7]||(a[7]=r=>t.value=r),producto:o.value,"is-editing":P.value,"is-viewing":A.value,onSubmit:Y},null,8,["modelValue","producto","is-editing","is-viewing"])]))}};export{gt as default};
